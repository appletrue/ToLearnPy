# 数据合并 

14.8. 合并
连接
pandas提供了大量的方法，能轻松的对Series，DataFrame和Panel执行合并操作。详情请查看 Merging section

使用concat()连接pandas对象:

>>> df = pd.DataFrame(np.random.randn(10, 4))
>>> df
          0         1         2         3
    0 -0.199614  1.914485  0.396383 -0.295306
    1 -0.061961 -1.352883  0.266751 -0.874132
    2  0.346504 -2.328099 -1.492250  0.095392
    3  0.187115  0.562740 -1.677737 -0.224807
    4 -1.422599 -1.028044  0.789487  0.806940
    5  0.439478 -0.592229  0.736081  1.008404
    6 -0.205641 -0.649465 -0.706395  0.578698
    7 -2.168725 -2.487189  0.060258  1.965318
    8  0.207634  0.512572  0.595373  0.816516
    9  0.764893  0.612208 -1.022504 -2.032126
>>> pieces = [df[:3], df[3:7], df[7:]]
>>> pd.concat(pieces)
          0         1         2         3
    0 -0.199614  1.914485  0.396383 -0.295306
    1 -0.061961 -1.352883  0.266751 -0.874132
    2  0.346504 -2.328099 -1.492250  0.095392
    3  0.187115  0.562740 -1.677737 -0.224807
    4 -1.422599 -1.028044  0.789487  0.806940
    5  0.439478 -0.592229  0.736081  1.008404
    6 -0.205641 -0.649465 -0.706395  0.578698
    7 -2.168725 -2.487189  0.060258  1.965318
    8  0.207634  0.512572  0.595373  0.816516
    9  0.764893  0.612208 -1.022504 -2.032126
Join
类似SQL的合并操作，详情请查看 Database style joining

栗子:

>>> left = pd.DataFrame({'key': ['foo', 'foo'], 'lval': [1, 2]})
>>> right = pd.DataFrame({'key': ['foo', 'foo'], 'rval': [4, 5]})
>>> left
    key  lval
    0  foo     1
    1  foo     2
>>> right
       key  rval
    0  foo     4
    1  foo     5
>>> pd.merge(left, right, on='key')
       key  lval  rval
    0  foo     1     4
    1  foo     1     5
    2  foo     2     4
    3  foo     2     5
栗子:

>>> left = pd.DataFrame({'key': ['foo', 'bar'], 'lval': [1, 2]})
>>> right = pd.DataFrame({'key': ['foo', 'bar'], 'rval': [4, 5]})
>>> left
    key  lval
    0  foo     1
    1  bar     2
>>> right
       key  rval
    0  foo     4
    1  bar     5
>>> pd.merge(left, right, on='key')
       key  lval  rval
    0  foo     1     4
    1  bar     2     5
追加，详情请查看 Appending:
>>> df = pd.DataFrame(np.random.randn(8, 4), columns=['A','B','C','D'])
>>> df
          A         B         C         D
    0 -1.710447  2.541720 -0.654403  0.132077
    1  0.667796 -1.124769 -0.430752 -0.244731
    2  1.555865 -0.483805  0.066114 -0.409518
    3  1.171798  0.036219 -0.515065  0.860625
    4 -0.834051 -2.178128 -0.345627  0.819392
    5 -0.354886  0.161204  1.465532  1.879841
    6  0.560888  1.208905  1.301983  0.799084
    7 -0.770196  0.307691  1.212200  0.909137
>>> s = df.iloc[3]
>>> df.append(s, ignore_index=True)
          A         B         C         D
    0 -1.710447  2.541720 -0.654403  0.132077
    1  0.667796 -1.124769 -0.430752 -0.244731
    2  1.555865 -0.483805  0.066114 -0.409518
    3  1.171798  0.036219 -0.515065  0.860625
    4 -0.834051 -2.178128 -0.345627  0.819392
    5 -0.354886  0.161204  1.465532  1.879841
    6  0.560888  1.208905  1.301983  0.799084
    7 -0.770196  0.307691  1.212200  0.909137
    8  1.171798  0.036219 -0.515065  0.860625
